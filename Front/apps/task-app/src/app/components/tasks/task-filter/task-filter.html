<div class="filter-container">
  <!-- Barre de recherche principale -->
  <div class="filter-bar">
    <!-- BoÃ®te de recherche redesignÃ©e -->
    <div class="search-box">
      <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <input 
        type="text" 
        placeholder="Rechercher une tÃ¢che, auteur, catÃ©gorie..." 
        [(ngModel)]="searchQuery"
        (keyup.enter)="applyFilters()"
        class="search-input"
      />
      <button 
        *ngIf="searchQuery" 
        class="btn-clear" 
        (click)="searchQuery = ''; applyFilters()"
        title="Effacer la recherche"
        type="button"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M18 6L6 18M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Boutons d'action -->
    <div class="filter-actions">
      <!-- Bouton Filtrer avancÃ© -->
      <button 
        class="btn-filter-toggle" 
        [class.active]="showAdvanced"
        (click)="toggleAdvanced()"
        title="Afficher/Masquer les filtres avancÃ©s"
        type="button"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 6a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707v5.172a1 1 0 01-1.414.414l-2-1.414A1 1 0 019 17.172v-5.172a1 1 0 00-.293-.707L2.293 8.707A1 1 0 012 8V6z"></path>
        </svg>
        <span class="label">Filtres</span>
        <span class="badge" *ngIf="hasActiveFilters()">{{ getFilterCount() }}</span>
      </button>

      <!-- Bouton RÃ©initialiser -->
      <button 
        class="btn-reset-filters"
        (click)="resetFilters()"
        [disabled]="!hasActiveFilters()"
        title="RÃ©initialiser tous les filtres"
        type="button"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.25 1.75h4.5a1.5 1.5 0 011.5 1.5v4.5m-12 12h-4.5a1.5 1.5 0 01-1.5-1.5v-4.5M6 3.75a8.25 8.25 0 1116.5 0"></path>
        </svg>
      </button>

      <!-- SÃ©parateur -->
      <div class="separator"></div>

      <!-- Options de tri -->
      <div class="sort-controls-compact">
        <select 
          [(ngModel)]="selectedTri" 
          (change)="applyFilters()"
          class="sort-select"
          title="Trier par"
        >
          <option *ngFor="let option of triOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>

        <select 
          [(ngModel)]="selectedOrdre" 
          (change)="applyFilters()"
          class="sort-select"
          title="Ordre"
        >
          <option value="asc">â†‘ Croissant</option>
          <option value="desc">â†“ DÃ©croissant</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Panneau des filtres avancÃ©s -->
  <div class="filter-panel" *ngIf="showAdvanced">
    <div class="filter-grid">
      <!-- Filtre Statut -->
      <div class="filter-item">
        <label for="statut-filter">
          <span class="filter-icon">ğŸ“‹</span>
          <span class="filter-label">Statut</span>
        </label>
        <select 
          id="statut-filter"
          [(ngModel)]="selectedStatut" 
          (change)="applyFilters()"
          class="filter-select"
        >
          <option value="">Tous les statuts</option>
          <option *ngFor="let statut of statuts" [value]="statut">{{ statut }}</option>
        </select>
        <div class="filter-tag" *ngIf="selectedStatut">
          {{ selectedStatut }}
          <button (click)="selectedStatut = ''; applyFilters()" class="btn-remove">âœ•</button>
        </div>
      </div>

      <!-- Filtre PrioritÃ© -->
      <div class="filter-item">
        <label for="priorite-filter">
          <span class="filter-icon">ğŸ”´</span>
          <span class="filter-label">PrioritÃ©</span>
        </label>
        <select 
          id="priorite-filter"
          [(ngModel)]="selectedPriorite" 
          (change)="applyFilters()"
          class="filter-select"
        >
          <option value="">Toutes les prioritÃ©s</option>
          <option *ngFor="let priorite of priorites" [value]="priorite">{{ priorite }}</option>
        </select>
        <div class="filter-tag" *ngIf="selectedPriorite">
          {{ selectedPriorite }}
          <button (click)="selectedPriorite = ''; applyFilters()" class="btn-remove">âœ•</button>
        </div>
      </div>

      <!-- Filtre CatÃ©gorie -->
      <div class="filter-item">
        <label for="categorie-filter">
          <span class="filter-icon">ğŸ·ï¸</span>
          <span class="filter-label">CatÃ©gorie</span>
        </label>
        <select 
          id="categorie-filter"
          [(ngModel)]="selectedCategorie" 
          (change)="applyFilters()"
          class="filter-select"
        >
          <option value="">Toutes les catÃ©gories</option>
          <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
        </select>
        <div class="filter-tag" *ngIf="selectedCategorie">
          {{ selectedCategorie }}
          <button (click)="selectedCategorie = ''; applyFilters()" class="btn-remove">âœ•</button>
        </div>
      </div>

      <!-- Filtre Ã‰tiquette -->
      <div class="filter-item">
        <label for="etiquette-filter">
          <span class="filter-icon">ğŸ·ï¸</span>
          <span class="filter-label">Ã‰tiquette</span>
        </label>
        <input 
          id="etiquette-filter"
          type="text"
          [(ngModel)]="selectedEtiquette"
          (keyup.enter)="applyFilters()"
          (blur)="applyFilters()"
          placeholder="Entrez une Ã©tiquette"
          class="filter-input"
        />
        <div class="filter-tag" *ngIf="selectedEtiquette">
          {{ selectedEtiquette }}
          <button (click)="selectedEtiquette = ''; applyFilters()" class="btn-remove">âœ•</button>
        </div>
      </div>

      <!-- Filtre Date Avant -->
      <div class="filter-item">
        <label for="date-avant-filter">
          <span class="filter-icon">ğŸ“…</span>
          <span class="filter-label">Avant le</span>
        </label>
        <input 
          id="date-avant-filter"
          type="date" 
          [(ngModel)]="dateAvant" 
          (change)="applyFilters()"
          class="filter-input"
        />
        <div class="filter-tag" *ngIf="dateAvant">
          {{ dateAvant }}
          <button (click)="dateAvant = ''; applyFilters()" class="btn-remove">âœ•</button>
        </div>
      </div>

      <!-- Filtre Date AprÃ¨s -->
      <div class="filter-item">
        <label for="date-apres-filter">
          <span class="filter-icon">ğŸ“…</span>
          <span class="filter-label">AprÃ¨s le</span>
        </label>
        <input 
          id="date-apres-filter"
          type="date" 
          [(ngModel)]="dateApres" 
          (change)="applyFilters()"
          class="filter-input"
        />
        <div class="filter-tag" *ngIf="dateApres">
          {{ dateApres }}
          <button (click)="dateApres = ''; applyFilters()" class="btn-remove">âœ•</button>
        </div>
      </div>
    </div>

    <!-- RÃ©sumÃ© des filtres actifs -->
    <div class="filters-summary" *ngIf="hasActiveFilters()">
      <span class="summary-label">Filtres actifs :</span>
      <div class="active-filters">
        <span class="filter-chip" *ngIf="searchQuery">
          ğŸ” "{{ searchQuery }}"
          <button (click)="searchQuery = ''; applyFilters()">Ã—</button>
        </span>
        <span class="filter-chip" *ngIf="selectedStatut">
          ğŸ“‹ {{ selectedStatut }}
          <button (click)="selectedStatut = ''; applyFilters()">Ã—</button>
        </span>
        <span class="filter-chip" *ngIf="selectedPriorite">
          ğŸ”´ {{ selectedPriorite }}
          <button (click)="selectedPriorite = ''; applyFilters()">Ã—</button>
        </span>
        <span class="filter-chip" *ngIf="selectedCategorie">
          ğŸ·ï¸ {{ selectedCategorie }}
          <button (click)="selectedCategorie = ''; applyFilters()">Ã—</button>
        </span>
        <span class="filter-chip" *ngIf="selectedEtiquette">
          ğŸ·ï¸ {{ selectedEtiquette }}
          <button (click)="selectedEtiquette = ''; applyFilters()">Ã—</button>
        </span>
        <span class="filter-chip" *ngIf="dateAvant">
          ğŸ“… Avant {{ dateAvant }}
          <button (click)="dateAvant = ''; applyFilters()">Ã—</button>
        </span>
        <span class="filter-chip" *ngIf="dateApres">
          ğŸ“… AprÃ¨s {{ dateApres }}
          <button (click)="dateApres = ''; applyFilters()">Ã—</button>
